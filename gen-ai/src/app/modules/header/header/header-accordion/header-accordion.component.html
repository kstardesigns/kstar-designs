@if (sidebarOpen) {
    <details class="bh-sidebar-details" #accDetails [attr.open]="accordionsOpen || null"> 
        <summary class="bh-sidebar-nav-header" #accSummary>
            <div class="bh-sidebar-nav-summary-flex">
                <div class="bh-sidebar-nav-header-text bh-subtitle-1">{{ accordionName }}</div>
                <svg class="bh-sidebar-nav-header-expand-icon" width="24" height="24" viewBox="0 0 24 24" fill="none"
                    xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">
                    <g>
                        <path d="M12 8.29504L6 14.295L7.41 15.705L12 11.125L16.59 15.705L18 14.295L12 8.29504Z" fill="#00205b" />
                    </g>
                </svg>
            </div>
        </summary>
        <div class="bh-sidebar-accordion-content" #accContent>
            @if (favoritesMenu) {
                <ul class="bh-sidebar-list">
                    @for (chat of favorites$ | async; track chat.chatId) {
                        <li class="bh-sidebar-list-item">
                            <button type="button" (click)="openChat(chat.chatId)" class="bh-sidebar-list-link bh-sidebar-list-link--services bh-body-2-tight">
                                <svg class="bh-svg-inline bh-svg-convo" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false">
                                    <title>Conversation</title>
                                    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                        <path fill="#00205b" d="M8.22857143,7.88571429 C8.22857143,8.45382857 8.68902857,8.91428571 9.25714286,8.91428571 C9.82525714,8.91428571 10.2857143,8.45382857 10.2857143,7.88571429 C10.2857143,7.3176 9.82525714,6.85714286 9.25714286,6.85714286 C8.68902857,6.85714286 8.22857143,7.3176 8.22857143,7.88571429 M12,7.88571429 C12,8.45382857 12.4604571,8.91428571 13.0285714,8.91428571 C13.5966857,8.91428571 14.0571429,8.45382857 14.0571429,7.88571429 C14.0571429,7.3176 13.5966857,6.85714286 13.0285714,6.85714286 C12.4604571,6.85714286 12,7.3176 12,7.88571429 M18.8571429,5.82857143 L17.8155429,5.82857143 C17.6396571,3.5304 15.7138286,1.71428571 13.3714286,1.71428571 L5.14285714,1.71428571 C2.68525714,1.71428571 0.685714286,3.71382857 0.685714286,6.17142857 L0.685714286,9.6 C0.685714286,11.9424 2.50182857,13.8682286 4.8,14.0441143 L4.8,17.1428571 C4.8,17.5381714 5.02662857,17.8985143 5.38285714,18.0699429 C5.73942857,18.2403429 6.16251429,18.1930286 6.47108571,17.9461714 L11.3324571,14.0571429 L13.3714286,14.0571429 C15.3226286,14.0571429 17.0304,12.8081143 17.6204571,10.9501714 C17.7922286,10.4081143 17.4929143,9.83005714 16.9512,9.65828571 C16.4077714,9.48651429 15.8314286,9.78617143 15.6596571,10.3272 C15.3418286,11.3276571 14.4222857,12 13.3714286,12 L10.9714286,12 C10.7376,12 10.5113143,12.0792 10.3289143,12.2252571 L6.85714286,15.0027429 L6.85714286,13.0285714 C6.85714286,12.4604571 6.39668571,12 5.82857143,12 L5.14285714,12 C3.81977143,12 2.74285714,10.9230857 2.74285714,9.6 L2.74285714,6.17142857 C2.74285714,4.84834286 3.81977143,3.77142857 5.14285714,3.77142857 L13.3714286,3.77142857 C14.6945143,3.77142857 15.7714286,4.84834286 15.7714286,6.17142857 L15.7714286,6.85714286 C15.7714286,7.42525714 16.2318857,7.88571429 16.8,7.88571429 L18.8571429,7.88571429 C20.1802286,7.88571429 21.2571429,8.96262857 21.2571429,10.2857143 L21.2571429,13.7142857 C21.2571429,15.0373714 20.1802286,16.1142857 18.8571429,16.1142857 L18.1714286,16.1142857 C17.6033143,16.1142857 17.1428571,16.5747429 17.1428571,17.1428571 L17.1428571,19.1170286 L13.6710857,16.3395429 C13.4886857,16.1934857 13.2624,16.1142857 13.0285714,16.1142857 L10.6285714,16.1142857 C10.5500571,16.1142857 10.4725714,16.1105143 10.3957714,16.1033143 C9.82662857,16.0464 9.32742857,16.4612571 9.27222857,17.0266286 C9.21668571,17.592 9.63017143,18.0949714 10.1955429,18.1501714 C10.3378286,18.1642286 10.4825143,18.1714286 10.6285714,18.1714286 L12.6675429,18.1714286 L17.5289143,22.0604571 C17.7147429,22.2089143 17.9420571,22.2857143 18.1714286,22.2857143 C18.3229714,22.2857143 18.4755429,22.2521143 18.6171429,22.1842286 C18.9733714,22.0128 19.2,21.6524571 19.2,21.2571429 L19.2,18.1584 C21.4981714,17.9825143 23.3142857,16.0566857 23.3142857,13.7142857 L23.3142857,10.2857143 C23.3142857,7.82811429 21.3147429,5.82857143 18.8571429,5.82857143 M4.45714286,7.88571429 C4.45714286,8.45382857 4.9176,8.91428571 5.48571429,8.91428571 C6.05382857,8.91428571 6.51428571,8.45382857 6.51428571,7.88571429 C6.51428571,7.3176 6.05382857,6.85714286 5.48571429,6.85714286 C4.9176,6.85714286 4.45714286,7.3176 4.45714286,7.88571429"></path>
                                    </g>
                                </svg>
                                <span class="bh-sidebar-link-name">{{ chat.chatName !== '' ? chat.chatName : 'Untitled' }}</span>
                            </button>
                            <button type="button" (click)="openConfirmationDialog('removeChatFromFavs', chat.chatId, chat.chatName)" class="bh-sidebar-list-remove" title="Remove from favorites" aria-label="Remove from favorites"><svg class="bh-sidebar-list-remove-icon" aria-hidden="true" focusable="false" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <title>Remove from favorites</title>
                                <g>
                                    <path fill-rule="evenodd" clip-rule="evenodd" d="M12 2C6.47 2 2 6.47 2 12C2 17.53 6.47 22 12 22C17.53 22 22 17.53 22 12C22 6.47 17.53 2 12 2ZM12 20C7.59 20 4 16.41 4 12C4 7.59 7.59 4 12 4C16.41 4 20 7.59 20 12C20 16.41 16.41 20 12 20ZM12 10.59L15.59 7L17 8.41L13.41 12L17 15.59L15.59 17L12 13.41L8.41 17L7 15.59L10.59 12L7 8.41L8.41 7L12 10.59Z" fill="#9ca0a5" />
                                </g>
                            </svg></button>
                        </li>
                    } @empty {
                        <li class="bh-sidebar-list-item bh-sidebar-list-item--empty bh-body-2-tight">Click the star next to your chat title to add it to favorites</li>
                    }
                </ul>
            }
    
            @if (historyMenu) {
                <ng-container *ngIf="(history$ | async) as chats">
                    <ul class="bh-sidebar-list">
                        @for (chat of chats; track chat.chatId) {
                            <li class="bh-sidebar-list-item">
                                <button type="button" (click)="openChat(chat.chatId)" class="bh-sidebar-list-link bh-sidebar-list-link--services bh-body-2-tight">
                                    <svg class="bh-svg-inline bh-svg-convo" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false">
                                        <title>Conversation</title>
                                        <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                            <path fill="#00205b" d="M8.22857143,7.88571429 C8.22857143,8.45382857 8.68902857,8.91428571 9.25714286,8.91428571 C9.82525714,8.91428571 10.2857143,8.45382857 10.2857143,7.88571429 C10.2857143,7.3176 9.82525714,6.85714286 9.25714286,6.85714286 C8.68902857,6.85714286 8.22857143,7.3176 8.22857143,7.88571429 M12,7.88571429 C12,8.45382857 12.4604571,8.91428571 13.0285714,8.91428571 C13.5966857,8.91428571 14.0571429,8.45382857 14.0571429,7.88571429 C14.0571429,7.3176 13.5966857,6.85714286 13.0285714,6.85714286 C12.4604571,6.85714286 12,7.3176 12,7.88571429 M18.8571429,5.82857143 L17.8155429,5.82857143 C17.6396571,3.5304 15.7138286,1.71428571 13.3714286,1.71428571 L5.14285714,1.71428571 C2.68525714,1.71428571 0.685714286,3.71382857 0.685714286,6.17142857 L0.685714286,9.6 C0.685714286,11.9424 2.50182857,13.8682286 4.8,14.0441143 L4.8,17.1428571 C4.8,17.5381714 5.02662857,17.8985143 5.38285714,18.0699429 C5.73942857,18.2403429 6.16251429,18.1930286 6.47108571,17.9461714 L11.3324571,14.0571429 L13.3714286,14.0571429 C15.3226286,14.0571429 17.0304,12.8081143 17.6204571,10.9501714 C17.7922286,10.4081143 17.4929143,9.83005714 16.9512,9.65828571 C16.4077714,9.48651429 15.8314286,9.78617143 15.6596571,10.3272 C15.3418286,11.3276571 14.4222857,12 13.3714286,12 L10.9714286,12 C10.7376,12 10.5113143,12.0792 10.3289143,12.2252571 L6.85714286,15.0027429 L6.85714286,13.0285714 C6.85714286,12.4604571 6.39668571,12 5.82857143,12 L5.14285714,12 C3.81977143,12 2.74285714,10.9230857 2.74285714,9.6 L2.74285714,6.17142857 C2.74285714,4.84834286 3.81977143,3.77142857 5.14285714,3.77142857 L13.3714286,3.77142857 C14.6945143,3.77142857 15.7714286,4.84834286 15.7714286,6.17142857 L15.7714286,6.85714286 C15.7714286,7.42525714 16.2318857,7.88571429 16.8,7.88571429 L18.8571429,7.88571429 C20.1802286,7.88571429 21.2571429,8.96262857 21.2571429,10.2857143 L21.2571429,13.7142857 C21.2571429,15.0373714 20.1802286,16.1142857 18.8571429,16.1142857 L18.1714286,16.1142857 C17.6033143,16.1142857 17.1428571,16.5747429 17.1428571,17.1428571 L17.1428571,19.1170286 L13.6710857,16.3395429 C13.4886857,16.1934857 13.2624,16.1142857 13.0285714,16.1142857 L10.6285714,16.1142857 C10.5500571,16.1142857 10.4725714,16.1105143 10.3957714,16.1033143 C9.82662857,16.0464 9.32742857,16.4612571 9.27222857,17.0266286 C9.21668571,17.592 9.63017143,18.0949714 10.1955429,18.1501714 C10.3378286,18.1642286 10.4825143,18.1714286 10.6285714,18.1714286 L12.6675429,18.1714286 L17.5289143,22.0604571 C17.7147429,22.2089143 17.9420571,22.2857143 18.1714286,22.2857143 C18.3229714,22.2857143 18.4755429,22.2521143 18.6171429,22.1842286 C18.9733714,22.0128 19.2,21.6524571 19.2,21.2571429 L19.2,18.1584 C21.4981714,17.9825143 23.3142857,16.0566857 23.3142857,13.7142857 L23.3142857,10.2857143 C23.3142857,7.82811429 21.3147429,5.82857143 18.8571429,5.82857143 M4.45714286,7.88571429 C4.45714286,8.45382857 4.9176,8.91428571 5.48571429,8.91428571 C6.05382857,8.91428571 6.51428571,8.45382857 6.51428571,7.88571429 C6.51428571,7.3176 6.05382857,6.85714286 5.48571429,6.85714286 C4.9176,6.85714286 4.45714286,7.3176 4.45714286,7.88571429"></path>
                                        </g>
                                    </svg>
                                    <span class="bh-sidebar-link-name">{{ chat.chatName !== '' ? chat.chatName : 'Untitled' }}</span>
                                </button>
                                <button type="button" (click)="openConfirmationDialog('removeChatFromHistory', chat.chatId, chat.chatName)" class="bh-sidebar-list-remove" title="Remove from recent history" aria-label="Remove from recent history"><svg class="bh-sidebar-list-remove-icon" aria-hidden="true" focusable="false" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <title>Remove from recent history</title>
                                    <g>
                                        <path fill-rule="evenodd" clip-rule="evenodd" d="M12 2C6.47 2 2 6.47 2 12C2 17.53 6.47 22 12 22C17.53 22 22 17.53 22 12C22 6.47 17.53 2 12 2ZM12 20C7.59 20 4 16.41 4 12C4 7.59 7.59 4 12 4C16.41 4 20 7.59 20 12C20 16.41 16.41 20 12 20ZM12 10.59L15.59 7L17 8.41L13.41 12L17 15.59L15.59 17L12 13.41L8.41 17L7 15.59L10.59 12L7 8.41L8.41 7L12 10.59Z" fill="#9ca0a5" />
                                    </g>
                                </svg></button>
                            </li>
                        } @empty {
                            <li class="bh-sidebar-list-item bh-sidebar-list-item--empty bh-body-2-tight">Your history will show up here after your first chat.</li>
                        }
        
                        @if (chats.length > 0) {
                            <li class="bh-sidebar-list-item">
                                <button type="button" (click)="openConfirmationDialog('removeAllHistory', '', '')" class="bh-sidebar-list-link bh-sidebar-list-link--delete bh-body-2-tight"><svg class="bh-sidebar-list-remove-icon" aria-hidden="true" focusable="false" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <title>Remove from recent history</title>
                                    <g>
                                        <path fill-rule="evenodd" clip-rule="evenodd" d="M12 2C6.47 2 2 6.47 2 12C2 17.53 6.47 22 12 22C17.53 22 22 17.53 22 12C22 6.47 17.53 2 12 2ZM12 20C7.59 20 4 16.41 4 12C4 7.59 7.59 4 12 4C16.41 4 20 7.59 20 12C20 16.41 16.41 20 12 20ZM12 10.59L15.59 7L17 8.41L13.41 12L17 15.59L15.59 17L12 13.41L8.41 17L7 15.59L10.59 12L7 8.41L8.41 7L12 10.59Z" fill="#00205b" />
                                    </g>
                                </svg>Delete all chat history</button>
                            </li>
                        }
                    </ul>
                </ng-container>
            }
        </div>
    </details>
}